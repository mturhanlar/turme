# PowerShell for Pentesters [Under Progress]

## What is Powershell?
- Powershell is a powerful built-in CLI or "shell" also task-orientes scripting language
- Mostly used by admins
- Built on top of .NET
- Scripts end with ".ps1"
- Version 5.0 onward introduce some hurdles regarding logging and restrictive modes
- Powershell 6.0 is available MacOS and Linux also as Docker image


## Fundamentals

'C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe' where exe files of powershell stays. 
    for 64-bit it stays under system32 directory. C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe
    for 32-bit it stays in C:\Windows\SysWOW64\WindowsPowerShell\v1.0\powershell.exe

```
#You can learn like that
PS C:\Windows\system32\WindowsPowerShell\v1.0> [Environment]::Is64BitProcess
True
```

You can learn detail with command below

```
C:\> powershell /?
```

Execution Policy 

```
powershell.exe -ExecutionPolicy Bypass ./shell.ps1
powershell.exe -ExecutionPolicy Unrestricted ./shell.ps1
powershell.exe -Command Get-Process
powershell.exe -Command "& {Get-Eventlog -Logname security}"
```

EncodedCommand:
Used to executed base64 command

```
powershell.exe -EncodedCommand $encodedCommand
```


- Like Man pages you can reach Get-Help section of all commands
  - `Get-Help Get-Help`
  - `Get-Help Get-Process -Full`  Gives full result regarding that command
  - `Get-Help Get-Process -Examples` you can learn examples of that commands
  You can updata man pages with Update-Help command

- You can learn commands by tunning the command so you don't need to memorize alll.
  `Get-Commands -Name *Log*`

  
### Cmdlets

- You can change formats of command results 
  - For ex. `Get-Childitem | Format-List *` 

- After learning all these commands you can pipe them to get objects 
  - For ex. `Get-Childitem | Sort-Object -Unique | Select-Object Basename`

- Redirection works as same like in other OS {<,>}
- You can use different format also 
  - `Get-Process notepad | Format-List Path`
  - or even
  - `Get-Process notepad | Format-List Path,Id,ProcessName`
  - 
- `Get-WmiObject -class win32_operatingsystem | Select -Property *`
- We can use `fl` as alias to `Format-List`
- If you want to you create csv file you can use Export-Csv 
  - `Get-WmiObject -Class win32_service | Select-Object Name, ProcessID | export-csv C:\Users\public\Documents\try.csv`

- In order to see Registry hives 
- `cd HKLM:\`
- Select-String is important command 
  - `Select-String -Path C:\Users\public\Documents\*.txt -Pattern yoursearch*`
- Get-Content
  - cat = Get-Content
- To learn servises which are running and available 
  - `Get-Service`
  - `Get-Service | Select-Object Name`
  - `Get-Service "n*" | Sort-Object status -Descending`

### Modules

### Scripts

### Objects


## Offensive PowerShell















